<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Bottle Matching Game</title>
    <link rel="stylesheet" href="style.css" />
    <link rel="manifest" href="manifest.json" />
    <link
      rel="icon"
      href="https://cdn-icons-png.flaticon.com/512/891/891462.png"
      type="image/png"
    />
  </head>

  <body>
    <div id="home-screen" class="screen active">
      <h1>Bottle Matching Game</h1>
      <p>Click on all bottles of the color shown before time runs out!</p>
      <button id="start-btn">Start Game</button>
    </div>

    <div id="game-screen" class="screen">
      <h2 id="instruction"></h2>
      <div id="bottle-container"></div>
      <div id="timer">Time Left: <span id="time">10</span>s</div>
    </div>

    <div id="result-screen" class="screen">
      <h2 id="result-message"></h2>
      <button id="play-again">Play Again</button>
    </div>

    <script>
      const startBtn = document.getElementById("start-btn");
      const playAgainBtn = document.getElementById("play-again");
      const homeScreen = document.getElementById("home-screen");
      const gameScreen = document.getElementById("game-screen");
      const resultScreen = document.getElementById("result-screen");
      const instruction = document.getElementById("instruction");
      const bottleContainer = document.getElementById("bottle-container");
      const timerDisplay = document.getElementById("time");
      const resultMessage = document.getElementById("result-message");

      const colors = ["red", "blue", "green", "yellow", "purple"];
      let correctColor, timeLeft, score, timer;

      startBtn.addEventListener("click", startGame);
      playAgainBtn.addEventListener("click", startGame);

      function startGame() {
        homeScreen.classList.remove("active");
        resultScreen.classList.remove("active");
        gameScreen.classList.add("active");
        score = 0;
        nextRound();
      }

      function nextRound() {
        bottleContainer.innerHTML = "";
        correctColor = colors[Math.floor(Math.random() * colors.length)];
        instruction.textContent = `Click all the ${correctColor} bottles!`;

        const totalBottles = 12;
        for (let i = 0; i < totalBottles; i++) {
          const color = colors[Math.floor(Math.random() * colors.length)];
          const bottle = document.createElement("img");
          bottle.src = "https://cdn-icons-png.flaticon.com/512/891/891462.png";
          bottle.classList.add("bottle");
          bottle.style.filter = `hue-rotate(${getHue(color)}deg)`;
          bottle.addEventListener("click", () => handleClick(bottle, color));
          bottleContainer.appendChild(bottle);
        }

        timeLeft = 10;
        timerDisplay.textContent = timeLeft;
        clearInterval(timer);
        timer = setInterval(() => {
          timeLeft--;
          timerDisplay.textContent = timeLeft;
          if (timeLeft === 0) endGame();
        }, 1000);
      }

      function handleClick(bottle, color) {
        if (color === correctColor) {
          bottle.style.visibility = "hidden";
          score++;
          if (
            score >=
            document.querySelectorAll(
              `.bottle[style*='${getHue(correctColor)}']`
            ).length
          ) {
            clearInterval(timer);
            setTimeout(nextRound, 1000);
          }
        }
      }

      function getHue(color) {
        const hues = {
          red: 0,
          yellow: 50,
          green: 100,
          blue: 200,
          purple: 280,
        };
        return hues[color];
      }

      function endGame() {
        clearInterval(timer);
        gameScreen.classList.remove("active");
        resultScreen.classList.add("active");
        resultMessage.textContent = "Game Over! Try Again?";
      }
    </script>
  </body>
</html>
